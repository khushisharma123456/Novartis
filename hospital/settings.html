<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - Hospital-Pharma Safety Intelligence Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --hospital-blue: #1a5f7a;
            --hospital-light-blue: #2a8bb3;
            --pharma-green: #2d7d46;
            --alert-red: #c53030;
            --warning-orange: #dd6b20;
            --safe-green: #38a169;
            --neutral-gray: #718096;
            --bg-light: #f7fafc;
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --border-radius: 12px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }

        body {
            background-color: var(--bg-light);
            color: #2d3748;
            line-height: 1.6;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: linear-gradient(to bottom, var(--hospital-blue), #1a4a5f);
            color: white;
            padding: 25px 20px;
            box-shadow: var(--card-shadow);
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo i {
            font-size: 28px;
            margin-right: 12px;
            color: #4fd1c7;
        }

        .logo-text h1 {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .logo-text span {
            font-size: 12px;
            opacity: 0.8;
            font-weight: 400;
        }

        .privacy-badge {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            padding: 6px 10px;
            font-size: 11px;
            display: inline-block;
            margin-top: 8px;
        }

        .nav-menu {
            list-style: none;
            margin-top: 30px;
        }

        .nav-item {
            margin-bottom: 8px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 14px 16px;
            color: #e2e8f0;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s;
            font-weight: 500;
        }

        .nav-link i {
            margin-right: 12px;
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        .nav-link:hover,
        .nav-link.active {
            background-color: rgba(79, 209, 199, 0.15);
            color: white;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e2e8f0;
        }

        .header-title h2 {
            color: var(--hospital-blue);
            font-weight: 700;
            font-size: 28px;
        }

        .header-title p {
            color: var(--neutral-gray);
            margin-top: 5px;
            font-size: 15px;
        }

        .hospital-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .hospital-badge {
            background-color: #ebf8ff;
            color: var(--hospital-blue);
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            border-left: 4px solid var(--hospital-light-blue);
        }

        /* Settings Container */
        .settings-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 30px;
            margin-top: 20px;
        }

        .settings-sidebar {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            padding: 0;
            overflow: hidden;
        }

        .settings-nav {
            list-style: none;
        }

        .settings-nav-item {
            border-bottom: 1px solid #f0f0f0;
        }

        .settings-nav-link {
            display: flex;
            align-items: center;
            padding: 20px 25px;
            color: #4a5568;
            text-decoration: none;
            transition: all 0.3s;
            font-weight: 500;
        }

        .settings-nav-link i {
            margin-right: 15px;
            font-size: 18px;
            color: var(--hospital-blue);
            width: 24px;
        }

        .settings-nav-link:hover,
        .settings-nav-link.active {
            background-color: #f7fafc;
            color: var(--hospital-blue);
            border-left: 4px solid var(--hospital-light-blue);
        }

        .settings-content {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
            padding: 0;
            overflow: hidden;
        }

        .settings-section {
            padding: 35px;
            display: none;
        }

        .settings-section.active {
            display: block;
        }

        .section-header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e2e8f0;
        }

        .section-header h3 {
            font-size: 22px;
            color: var(--hospital-blue);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }

        .section-header h3 i {
            margin-right: 12px;
            font-size: 24px;
        }

        .section-header p {
            color: var(--neutral-gray);
            font-size: 15px;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #2d3748;
            font-size: 15px;
        }

        .form-label span {
            color: var(--neutral-gray);
            font-weight: normal;
            font-size: 14px;
        }

        .form-control {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 15px;
            transition: border-color 0.3s;
            background-color: #fafafa;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--hospital-light-blue);
            background-color: white;
            box-shadow: 0 0 0 3px rgba(42, 139, 179, 0.1);
        }

        .form-control.select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23718096' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14L2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            padding-right: 40px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }

        .checkbox-group {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .checkbox-group input[type="checkbox"] {
            margin-top: 3px;
            margin-right: 12px;
            cursor: pointer;
            width: 18px;
            height: 18px;
        }

        .checkbox-group label {
            cursor: pointer;
            flex: 1;
        }

        .checkbox-description {
            display: block;
            color: var(--neutral-gray);
            font-size: 14px;
            margin-top: 5px;
            margin-left: 30px;
        }

        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
            margin-right: 15px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked+.toggle-slider {
            background-color: var(--safe-green);
        }

        input:checked+.toggle-slider:before {
            transform: translateX(30px);
        }

        .toggle-container {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .toggle-label {
            font-weight: 500;
        }

        /* Card Settings */
        .settings-card {
            background: #f8fafc;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 4px solid var(--hospital-light-blue);
        }

        .settings-card h4 {
            font-size: 17px;
            margin-bottom: 15px;
            color: var(--hospital-blue);
            display: flex;
            align-items: center;
        }

        .settings-card h4 i {
            margin-right: 10px;
        }

        /* Compliance Badge */
        .compliance-badge {
            display: inline-flex;
            align-items: center;
            background: #e6fffa;
            color: #234e52;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .compliance-badge i {
            margin-right: 8px;
        }

        /* Button Styles */
        .btn {
            padding: 14px 28px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 15px;
            display: inline-flex;
            align-items: center;
        }

        .btn i {
            margin-right: 10px;
        }

        .btn-primary {
            background-color: var(--hospital-light-blue);
            color: white;
        }

        .btn-primary:hover {
            background-color: #237299;
        }

        .btn-secondary {
            background-color: #edf2f7;
            color: #4a5568;
        }

        .btn-secondary:hover {
            background-color: #e2e8f0;
        }

        .btn-success {
            background-color: var(--safe-green);
            color: white;
        }

        .btn-success:hover {
            background-color: #2f855a;
        }

        .btn-danger {
            background-color: var(--alert-red);
            color: white;
        }

        .btn-danger:hover {
            background-color: #9b2c2c;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            padding-top: 25px;
            border-top: 1px solid #e2e8f0;
        }

        /* User Table */
        .user-table {
            width: 100%;
            border-collapse: collapse;
        }

        .user-table th {
            background-color: #f7fafc;
            padding: 16px 20px;
            text-align: left;
            font-weight: 600;
            color: var(--hospital-blue);
            border-bottom: 2px solid #e2e8f0;
            font-size: 14px;
        }

        .user-table td {
            padding: 16px 20px;
            border-bottom: 1px solid #f0f0f0;
        }

        .user-table tr:hover {
            background-color: #f7fafc;
        }

        .role-badge {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            display: inline-block;
        }

        .role-admin {
            background-color: #bee3f8;
            color: #2b6cb0;
        }

        .role-physician {
            background-color: #c6f6d5;
            color: var(--safe-green);
        }

        .role-nurse {
            background-color: #fed7d7;
            color: var(--alert-red);
        }

        .role-pharma {
            background-color: #e9d8fd;
            color: #6b46c1;
        }

        /* Data Retention Card */
        .retention-card {
            background: linear-gradient(to right, #fff5f5, #fed7d7);
            border-radius: 10px;
            padding: 25px;
            margin-top: 25px;
            border-left: 4px solid var(--alert-red);
        }

        .retention-card h4 {
            color: var(--alert-red);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .retention-card h4 i {
            margin-right: 10px;
        }

        /* Activity Log */
        .activity-log {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .activity-item {
            padding: 15px 0;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: flex-start;
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .activity-icon.success {
            background-color: #c6f6d5;
            color: var(--safe-green);
        }

        .activity-icon.warning {
            background-color: #feebc8;
            color: var(--warning-orange);
        }

        .activity-icon.info {
            background-color: #bee3f8;
            color: var(--hospital-blue);
        }

        .activity-content {
            flex: 1;
        }

        .activity-content strong {
            color: #2d3748;
        }

        .activity-time {
            color: var(--neutral-gray);
            font-size: 13px;
            margin-top: 5px;
        }

        /* Responsive */
        @media (max-width: 1100px) {
            .settings-container {
                grid-template-columns: 1fr;
            }

            .settings-sidebar {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                align-items: flex-start;
            }

            .hospital-info {
                margin-top: 15px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <i class="fas fa-shield-alt"></i>
                <div class="logo-text">
                    <h1>Safety Intelligence</h1>
                    <span>Hospitalâ€“Pharma Collaboration</span>
                    <div class="privacy-badge">
                        <i class="fas fa-lock"></i> HIPAA/GDPR Compliant
                    </div>
                </div>
            </div>

            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#" class="nav-link" onclick="window.location.href='dashboard.html'">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" onclick="window.location.href='internal-data.html'">
                        <i class="fas fa-user-shield"></i>
                        <span>Internal Data</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" onclick="window.location.href='safety-alerts.html'">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>Safety Alerts</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" onclick="window.location.href='analytics.html'">
                        <i class="fas fa-chart-bar"></i>
                        <span>Analytics</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link active">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-title">
                    <h2>Dashboard Settings</h2>
                    <p>Configure data sharing, notifications, and user permissions</p>
                </div>
                <div class="hospital-info">
                    <div class="hospital-badge">
                        <i class="fas fa-hospital"></i> General Hospital
                    </div>
                    <div class="btn btn-secondary">
                        <i class="fas fa-question-circle"></i> Help
                    </div>
                </div>
            </div>

            <!-- Settings Container -->
            <div class="settings-container">
                <!-- Settings Sidebar -->
                <div class="settings-sidebar">
                    <ul class="settings-nav">
                        <li class="settings-nav-item">
                            <a href="#" class="settings-nav-link active" data-section="data-sharing">
                                <i class="fas fa-database"></i>
                                Data Sharing
                            </a>
                        </li>
                        <li class="settings-nav-item">
                            <a href="#" class="settings-nav-link" data-section="notifications">
                                <i class="fas fa-bell"></i>
                                Notifications
                            </a>
                        </li>
                        <li class="settings-nav-item">
                            <a href="#" class="settings-nav-link" data-section="user-management">
                                <i class="fas fa-users"></i>
                                User Management
                            </a>
                        </li>
                        <li class="settings-nav-item">
                            <a href="#" class="settings-nav-link" data-section="privacy-compliance">
                                <i class="fas fa-lock"></i>
                                Privacy & Compliance
                            </a>
                        </li>
                        <li class="settings-nav-item">
                            <a href="#" class="settings-nav-link" data-section="pharma-connections">
                                <i class="fas fa-handshake"></i>
                                Pharma Connections
                            </a>
                        </li>
                        <li class="settings-nav-item">
                            <a href="#" class="settings-nav-link" data-section="api-integration">
                                <i class="fas fa-code"></i>
                                API & Integration
                            </a>
                        </li>
                        <li class="settings-nav-item">
                            <a href="#" class="settings-nav-link" data-section="backup-recovery">
                                <i class="fas fa-save"></i>
                                Backup & Recovery
                            </a>
                        </li>
                        <li class="settings-nav-item">
                            <a href="#" class="settings-nav-link" data-section="audit-log">
                                <i class="fas fa-history"></i>
                                Audit Log
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Settings Content -->
                <div class="settings-content">
                    <!-- Data Sharing Section -->
                    <div class="settings-section active" id="data-sharing">
                        <div class="section-header">
                            <h3><i class="fas fa-database"></i> Data Sharing Preferences</h3>
                            <p>Control what anonymized data is shared with pharmaceutical partners</p>
                        </div>

                        <div class="compliance-badge">
                            <i class="fas fa-shield-alt"></i> HIPAA/GDPR Compliant by Design
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-user-secret"></i> Anonymization Settings</h4>
                            <div class="toggle-container">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="auto-anonymize" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span class="toggle-label">Automatic Anonymization</span>
                            </div>
                            <p class="checkbox-description">All patient identifiers are automatically removed before
                                data sharing</p>

                            <div class="form-group">
                                <label class="form-label">Minimum Group Size for Reporting</label>
                                <select class="form-control select" id="min-group-size">
                                    <option value="5">5 patients (Most detailed)</option>
                                    <option value="10" selected>10 patients (Recommended)</option>
                                    <option value="20">20 patients (More private)</option>
                                    <option value="50">50 patients (Most private)</option>
                                </select>
                                <p class="checkbox-description">Prevents identification through small sample sizes</p>
                            </div>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-share-alt"></i> Data Sharing Controls</h4>
                            <div class="checkbox-group">
                                <input type="checkbox" id="share-demographics" checked>
                                <label for="share-demographics">Share age group and gender</label>
                            </div>
                            <p class="checkbox-description">Age bands (e.g., 30-40) and gender for safety pattern
                                analysis</p>

                            <div class="checkbox-group">
                                <input type="checkbox" id="share-diagnosis" checked>
                                <label for="share-diagnosis">Share diagnosis codes (anonymized)</label>
                            </div>
                            <p class="checkbox-description">ICD codes without patient identifiers</p>

                            <div class="checkbox-group">
                                <input type="checkbox" id="share-medication" checked>
                                <label for="share-medication">Share medication and dosage information</label>
                            </div>
                            <p class="checkbox-description">Drug names and dosage ranges</p>

                            <div class="checkbox-group">
                                <input type="checkbox" id="share-outcomes" checked>
                                <label for="share-outcomes">Share treatment outcomes and adverse effects</label>
                            </div>
                            <p class="checkbox-description">Efficacy and safety data for drug monitoring</p>

                            <div class="checkbox-group">
                                <input type="checkbox" id="share-geographic">
                                <label for="share-geographic">Share geographic region (optional)</label>
                            </div>
                            <p class="checkbox-description">Broad region (e.g., "North India") for epidemiological
                                studies</p>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-building"></i> Pharmaceutical Company Access</h4>
                            <div class="checkbox-group">
                                <input type="checkbox" id="all-pharma-access" checked>
                                <label for="all-pharma-access">Share with all registered pharmaceutical
                                    companies</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="specific-pharma-access">
                                <label for="specific-pharma-access">Share only with specific companies</label>
                            </div>

                            <div class="form-group" id="pharma-list-container" style="display: none; margin-top: 15px;">
                                <label class="form-label">Select Companies</label>
                                <div class="checkbox-group">
                                    <input type="checkbox" id="pharma-medipharm">
                                    <label for="pharma-medipharm">MediPharm Inc.</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" id="pharma-neurohealth">
                                    <label for="pharma-neurohealth">NeuroHealth Pharma</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" id="pharma-heartcare">
                                    <label for="pharma-heartcare">HeartCare Corp</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" id="pharma-global">
                                    <label for="pharma-global">Global Pharma Solutions</label>
                                </div>
                            </div>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary" id="save-data-sharing">
                                <i class="fas fa-save"></i> Save Data Sharing Settings
                            </button>
                            <button class="btn btn-secondary" id="reset-data-sharing">
                                <i class="fas fa-undo"></i> Reset to Defaults
                            </button>
                        </div>
                    </div>

                    <!-- Notifications Section -->
                    <div class="settings-section" id="notifications">
                        <div class="section-header">
                            <h3><i class="fas fa-bell"></i> Notification Preferences</h3>
                            <p>Configure how and when you receive alerts</p>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-exclamation-triangle"></i> Safety Alert Notifications</h4>
                            <div class="toggle-container">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="notify-safety-alerts" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span class="toggle-label">Enable safety alert notifications</span>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Alert Severity Level</label>
                                <select class="form-control select" id="alert-severity">
                                    <option value="all">All alerts (including informational)</option>
                                    <option value="moderate" selected>Moderate and critical only</option>
                                    <option value="critical">Critical alerts only</option>
                                </select>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="notify-email" checked>
                                <label for="notify-email">Email notifications</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="notify-sms">
                                <label for="notify-sms">SMS notifications for critical alerts</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="notify-dashboard" checked>
                                <label for="notify-dashboard">Dashboard notifications</label>
                            </div>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-calendar-alt"></i> Schedule & Frequency</h4>
                            <div class="form-group">
                                <label class="form-label">Daily Summary Email</label>
                                <select class="form-control select" id="daily-summary-time">
                                    <option value="off">Off</option>
                                    <option value="08:00">8:00 AM</option>
                                    <option value="17:00" selected>5:00 PM</option>
                                    <option value="20:00">8:00 PM</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Weekly Analytics Report</label>
                                <select class="form-control select" id="weekly-report-day">
                                    <option value="off">Off</option>
                                    <option value="monday">Monday</option>
                                    <option value="friday" selected>Friday</option>
                                </select>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="notify-new-drugs" checked>
                                <label for="notify-new-drugs">Notify about new drug safety data</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="notify-study-requests">
                                <label for="notify-study-requests">Notify about patient study requests</label>
                            </div>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-user-md"></i> Department-Specific Notifications</h4>
                            <div class="checkbox-group">
                                <input type="checkbox" id="dept-cardiology" checked>
                                <label for="dept-cardiology">Cardiology department alerts</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="dept-neurology" checked>
                                <label for="dept-neurology">Neurology department alerts</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="dept-orthopedics">
                                <label for="dept-orthopedics">Orthopedics department alerts</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="dept-pediatrics" checked>
                                <label for="dept-pediatrics">Pediatrics department alerts</label>
                            </div>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary" id="save-notifications">
                                <i class="fas fa-save"></i> Save Notification Settings
                            </button>
                        </div>
                    </div>

                    <!-- User Management Section -->
                    <div class="settings-section" id="user-management">
                        <div class="section-header">
                            <h3><i class="fas fa-users"></i> User Management</h3>
                            <p>Manage dashboard users and permissions</p>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-user-plus"></i> Add New User</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Full Name</label>
                                    <input type="text" class="form-control" id="new-user-name"
                                        placeholder="Enter full name">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Email Address</label>
                                    <input type="email" class="form-control" id="new-user-email"
                                        placeholder="user@hospital.org">
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Role</label>
                                    <select class="form-control select" id="new-user-role">
                                        <option value="admin">Administrator</option>
                                        <option value="physician">Physician</option>
                                        <option value="nurse">Nurse</option>
                                        <option value="researcher">Researcher</option>
                                        <option value="viewer">Viewer (Read-only)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Department</label>
                                    <select class="form-control select" id="new-user-dept">
                                        <option value="all">All Departments</option>
                                        <option value="cardiology">Cardiology</option>
                                        <option value="neurology">Neurology</option>
                                        <option value="orthopedics">Orthopedics</option>
                                        <option value="pediatrics">Pediatrics</option>
                                        <option value="pharmacy">Pharmacy</option>
                                    </select>
                                </div>
                            </div>

                            <button class="btn btn-success" id="add-user-btn">
                                <i class="fas fa-plus"></i> Add User
                            </button>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-list"></i> Current Users</h4>
                            <table class="user-table">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Role</th>
                                        <th>Department</th>
                                        <th>Last Active</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="users-table">
                                    <!-- Populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-user-shield"></i> Permission Levels</h4>
                            <div class="form-group">
                                <label class="form-label">Default Role for New Users</label>
                                <select class="form-control select" id="default-role">
                                    <option value="viewer">Viewer (Read-only)</option>
                                    <option value="nurse">Nurse</option>
                                    <option value="physician" selected>Physician</option>
                                </select>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="allow-data-export" checked>
                                <label for="allow-data-export">Allow users to export data (admins only)</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="allow-patient-add" checked>
                                <label for="allow-patient-add">Allow adding new patient records</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="allow-settings-change">
                                <label for="allow-settings-change">Allow non-admins to change settings</label>
                            </div>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary" id="save-user-settings">
                                <i class="fas fa-save"></i> Save User Settings
                            </button>
                        </div>
                    </div>

                    <!-- Privacy & Compliance Section -->
                    <div class="settings-section" id="privacy-compliance">
                        <div class="section-header">
                            <h3><i class="fas fa-lock"></i> Privacy & Compliance</h3>
                            <p>Configure data retention and compliance settings</p>
                        </div>

                        <div class="compliance-badge">
                            <i class="fas fa-gavel"></i> Compliance Mode: HIPAA + GDPR
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-calendar-times"></i> Data Retention Policies</h4>
                            <div class="form-group">
                                <label class="form-label">Anonymized Data Retention</label>
                                <select class="form-control select" id="anon-retention">
                                    <option value="1">1 year</option>
                                    <option value="3">3 years</option>
                                    <option value="5" selected>5 years (Recommended)</option>
                                    <option value="7">7 years</option>
                                    <option value="10">10 years</option>
                                    <option value="forever">Indefinitely</option>
                                </select>
                                <p class="checkbox-description">How long anonymized safety signals are retained for
                                    analysis</p>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Patient Data Retention (Internal)</label>
                                <select class="form-control select" id="patient-retention">
                                    <option value="7">7 years (Minimum legal)</option>
                                    <option value="10" selected>10 years (Standard)</option>
                                    <option value="15">15 years</option>
                                    <option value="20">20 years</option>
                                </select>
                                <p class="checkbox-description">How long identifiable patient records are kept in
                                    hospital system</p>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="auto-delete" checked>
                                <label for="auto-delete">Automatically delete data after retention period</label>
                            </div>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-file-contract"></i> Consent Management</h4>
                            <div class="toggle-container">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="require-consent" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span class="toggle-label">Require patient consent for study participation</span>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Consent Form Version</label>
                                <input type="text" class="form-control" id="consent-version" value="v2.3 (2023-10-15)"
                                    readonly>
                                <p class="checkbox-description">Current approved consent form for patient studies</p>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="log-consent-changes" checked>
                                <label for="log-consent-changes">Log all consent changes in audit trail</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="allow-consent-withdrawal" checked>
                                <label for="allow-consent-withdrawal">Allow patients to withdraw consent</label>
                            </div>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-shield-alt"></i> Security Settings</h4>
                            <div class="checkbox-group">
                                <input type="checkbox" id="two-factor-auth" checked>
                                <label for="two-factor-auth">Require two-factor authentication for admins</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="session-timeout" checked>
                                <label for="session-timeout">Automatic session timeout after 30 minutes</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="ip-restriction">
                                <label for="ip-restriction">Restrict access to hospital IP addresses only</label>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Password Policy</label>
                                <select class="form-control select" id="password-policy">
                                    <option value="basic">Basic (8 characters)</option>
                                    <option value="standard" selected>Standard (12 characters, mixed)</option>
                                    <option value="strict">Strict (16 characters, special chars)</option>
                                </select>
                            </div>
                        </div>

                        <div class="retention-card">
                            <h4><i class="fas fa-exclamation-triangle"></i> Data Deletion Warning</h4>
                            <p>Deleting data before the minimum retention period may violate regulatory requirements.
                                Please consult with your compliance officer before changing these settings.</p>
                            <button class="btn btn-danger" id="emergency-delete" style="margin-top: 15px;">
                                <i class="fas fa-trash-alt"></i> Emergency Data Deletion
                            </button>
                            <p class="checkbox-description">Only use in case of data breach or legal requirement</p>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary" id="save-compliance">
                                <i class="fas fa-save"></i> Save Compliance Settings
                            </button>
                            <button class="btn btn-secondary" id="audit-compliance">
                                <i class="fas fa-file-alt"></i> Generate Compliance Report
                            </button>
                        </div>
                    </div>

                    <!-- Pharma Connections Section -->
                    <div class="settings-section" id="pharma-connections">
                        <div class="section-header">
                            <h3><i class="fas fa-handshake"></i> Pharmaceutical Connections</h3>
                            <p>Manage connections with pharmaceutical companies</p>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-network-wired"></i> Active Connections</h4>
                            <table class="user-table">
                                <thead>
                                    <tr>
                                        <th>Company</th>
                                        <th>Status</th>
                                        <th>Data Access</th>
                                        <th>Connection Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="pharma-connections-table">
                                    <!-- Populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-plus-circle"></i> Request New Connection</h4>
                            <div class="form-group">
                                <label class="form-label">Pharmaceutical Company</label>
                                <select class="form-control select" id="new-pharma-company">
                                    <option value="">Select a company</option>
                                    <option value="medipharm">MediPharm Inc.</option>
                                    <option value="neurohealth">NeuroHealth Pharma</option>
                                    <option value="heartcare">HeartCare Corp</option>
                                    <option value="global">Global Pharma Solutions</option>
                                    <option value="biogen">BioGen Therapeutics</option>
                                    <option value="novamed">NovaMed Pharmaceuticals</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Connection Type</label>
                                <select class="form-control select" id="connection-type">
                                    <option value="readonly">Read-only safety data</option>
                                    <option value="bidirectional" selected>Bidirectional (alerts + data)</option>
                                    <option value="studies">Patient study collaboration</option>
                                </select>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="auto-approve">
                                <label for="auto-approve">Auto-approve safety alerts from this company</label>
                            </div>

                            <button class="btn btn-success" id="request-connection">
                                <i class="fas fa-handshake"></i> Request Connection
                            </button>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-sliders-h"></i> Connection Settings</h4>
                            <div class="checkbox-group">
                                <input type="checkbox" id="auto-share-new-data" checked>
                                <label for="auto-share-new-data">Automatically share new anonymized data</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="require-alert-approval">
                                <label for="require-alert-approval">Require approval for all safety alerts</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="log-all-exchanges" checked>
                                <label for="log-all-exchanges">Log all data exchanges with pharma companies</label>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Maximum Data Refresh Rate</label>
                                <select class="form-control select" id="data-refresh-rate">
                                    <option value="realtime">Real-time (as data arrives)</option>
                                    <option value="hourly" selected>Hourly</option>
                                    <option value="daily">Daily at midnight</option>
                                    <option value="weekly">Weekly</option>
                                </select>
                            </div>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary" id="save-pharma-settings">
                                <i class="fas fa-save"></i> Save Connection Settings
                            </button>
                            <button class="btn btn-secondary" id="test-connections">
                                <i class="fas fa-wifi"></i> Test All Connections
                            </button>
                        </div>
                    </div>

                    <!-- API & Integration Section -->
                    <div class="settings-section" id="api-integration">
                        <div class="section-header">
                            <h3><i class="fas fa-code"></i> API & Integration</h3>
                            <p>Configure system integrations and API access</p>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-plug"></i> System Integrations</h4>
                            <div class="toggle-container">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="integrate-ehr" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span class="toggle-label">Integrate with Hospital EHR System</span>
                            </div>
                            <p class="checkbox-description">Automatically import patient data from Electronic Health
                                Records</p>

                            <div class="toggle-container">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="integrate-pharmacy">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span class="toggle-label">Integrate with Pharmacy System</span>
                            </div>

                            <div class="toggle-container">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="integrate-lab">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span class="toggle-label">Integrate with Laboratory System</span>
                            </div>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-key"></i> API Access</h4>
                            <div class="form-group">
                                <label class="form-label">API Key</label>
                                <div style="display: flex; gap: 10px;">
                                    <input type="text" class="form-control" id="api-key"
                                        value="sk_hosp_7a9b3c2d1e5f8g6h4i0j" readonly style="font-family: monospace;">
                                    <button class="btn btn-secondary" id="copy-api-key">
                                        <i class="fas fa-copy"></i> Copy
                                    </button>
                                    <button class="btn btn-danger" id="regenerate-api-key">
                                        <i class="fas fa-redo"></i> Regenerate
                                    </button>
                                </div>
                                <p class="checkbox-description">Use this key for programmatic access to the safety
                                    intelligence API</p>
                            </div>

                            <div class="form-group">
                                <label class="form-label">API Rate Limit</label>
                                <select class="form-control select" id="api-rate-limit">
                                    <option value="10">10 requests/minute</option>
                                    <option value="30">30 requests/minute</option>
                                    <option value="60" selected>60 requests/minute</option>
                                    <option value="100">100 requests/minute</option>
                                    <option value="unlimited">Unlimited</option>
                                </select>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="api-logging" checked>
                                <label for="api-logging">Enable detailed API request logging</label>
                            </div>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-exchange-alt"></i> Data Export Formats</h4>
                            <div class="checkbox-group">
                                <input type="checkbox" id="export-json" checked>
                                <label for="export-json">JSON</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="export-csv" checked>
                                <label for="export-csv">CSV</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="export-xml">
                                <label for="export-xml">XML</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="export-fhir">
                                <label for="export-fhir">FHIR (Fast Healthcare Interoperability Resources)</label>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Default Export Timezone</label>
                                <select class="form-control select" id="export-timezone">
                                    <option value="UTC">UTC</option>
                                    <option value="local" selected>Hospital Local Time</option>
                                </select>
                            </div>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary" id="save-api-settings">
                                <i class="fas fa-save"></i> Save Integration Settings
                            </button>
                            <button class="btn btn-secondary" id="test-integrations">
                                <i class="fas fa-vial"></i> Test Integrations
                            </button>
                        </div>
                    </div>

                    <!-- Backup & Recovery Section -->
                    <div class="settings-section" id="backup-recovery">
                        <div class="section-header">
                            <h3><i class="fas fa-save"></i> Backup & Recovery</h3>
                            <p>Configure data backup and disaster recovery</p>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-history"></i> Backup Schedule</h4>
                            <div class="form-group">
                                <label class="form-label">Backup Frequency</label>
                                <select class="form-control select" id="backup-frequency">
                                    <option value="daily">Daily</option>
                                    <option value="weekly" selected>Weekly</option>
                                    <option value="monthly">Monthly</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Backup Time</label>
                                <select class="form-control select" id="backup-time">
                                    <option value="00:00">12:00 AM</option>
                                    <option value="02:00">2:00 AM</option>
                                    <option value="04:00" selected>4:00 AM (Recommended)</option>
                                    <option value="06:00">6:00 AM</option>
                                </select>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="backup-patient-data" checked>
                                <label for="backup-patient-data">Include patient data in backups</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="backup-anon-data" checked>
                                <label for="backup-anon-data">Include anonymized safety data</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="backup-settings" checked>
                                <label for="backup-settings">Include system settings</label>
                            </div>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-cloud"></i> Backup Storage</h4>
                            <div class="form-group">
                                <label class="form-label">Primary Backup Location</label>
                                <select class="form-control select" id="backup-location">
                                    <option value="local">Local Hospital Server</option>
                                    <option value="cloud" selected>Secure Cloud Storage</option>
                                    <option value="both">Both Local and Cloud</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Retain Backups For</label>
                                <select class="form-control select" id="backup-retention">
                                    <option value="30">30 days</option>
                                    <option value="90" selected>90 days</option>
                                    <option value="180">180 days</option>
                                    <option value="365">1 year</option>
                                    <option value="730">2 years</option>
                                </select>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="encrypt-backups" checked>
                                <label for="encrypt-backups">Encrypt all backup files</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="verify-backups" checked>
                                <label for="verify-backups">Automatically verify backup integrity</label>
                            </div>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-redo"></i> Recovery Options</h4>
                            <div class="form-group">
                                <label class="form-label">Recovery Point Objective (RPO)</label>
                                <select class="form-control select" id="rpo">
                                    <option value="1">1 hour</option>
                                    <option value="4">4 hours</option>
                                    <option value="24" selected>24 hours</option>
                                    <option value="168">1 week</option>
                                </select>
                                <p class="checkbox-description">Maximum acceptable data loss in case of disaster</p>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Recovery Time Objective (RTO)</label>
                                <select class="form-control select" id="rto">
                                    <option value="1">1 hour</option>
                                    <option value="4" selected>4 hours</option>
                                    <option value="8">8 hours</option>
                                    <option value="24">24 hours</option>
                                </select>
                                <p class="checkbox-description">Maximum acceptable downtime</p>
                            </div>

                            <button class="btn btn-secondary" id="manual-backup">
                                <i class="fas fa-save"></i> Create Manual Backup Now
                            </button>

                            <button class="btn btn-danger" id="disaster-recovery">
                                <i class="fas fa-ambulance"></i> Initiate Disaster Recovery
                            </button>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary" id="save-backup-settings">
                                <i class="fas fa-save"></i> Save Backup Settings
                            </button>
                            <button class="btn btn-secondary" id="view-backup-history">
                                <i class="fas fa-history"></i> View Backup History
                            </button>
                        </div>
                    </div>

                    <!-- Audit Log Section -->
                    <div class="settings-section" id="audit-log">
                        <div class="section-header">
                            <h3><i class="fas fa-history"></i> Audit Log</h3>
                            <p>View system activity and access logs</p>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-filter"></i> Filter Logs</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Time Period</label>
                                    <select class="form-control select" id="log-period">
                                        <option value="today">Today</option>
                                        <option value="week" selected>Last 7 days</option>
                                        <option value="month">Last 30 days</option>
                                        <option value="quarter">Last 90 days</option>
                                        <option value="all">All time</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Activity Type</label>
                                    <select class="form-control select" id="log-type">
                                        <option value="all">All Activities</option>
                                        <option value="user">User Actions</option>
                                        <option value="data">Data Access</option>
                                        <option value="system">System Events</option>
                                        <option value="security">Security Events</option>
                                        <option value="pharma">Pharma Interactions</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">User</label>
                                <select class="form-control select" id="log-user">
                                    <option value="all">All Users</option>
                                    <option value="admin">Administrators</option>
                                    <option value="dr_smith">Dr. Smith</option>
                                    <option value="nurse_jones">Nurse Jones</option>
                                </select>
                            </div>

                            <button class="btn btn-secondary" id="apply-log-filters">
                                <i class="fas fa-filter"></i> Apply Filters
                            </button>

                            <button class="btn btn-secondary" id="export-logs">
                                <i class="fas fa-download"></i> Export Logs
                            </button>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-list-alt"></i> Recent Activities</h4>
                            <div class="activity-log" id="activity-log">
                                <!-- Populated by JavaScript -->
                            </div>
                        </div>

                        <div class="settings-card">
                            <h4><i class="fas fa-cog"></i> Audit Log Settings</h4>
                            <div class="checkbox-group">
                                <input type="checkbox" id="log-all-actions" checked>
                                <label for="log-all-actions">Log all user actions</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="log-data-access" checked>
                                <label for="log-data-access">Log all data access attempts</label>
                            </div>

                            <div class="checkbox-group">
                                <input type="checkbox" id="log-pharma-interactions" checked>
                                <label for="log-pharma-interactions">Log all pharmaceutical interactions</label>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Log Retention Period</label>
                                <select class="form-control select" id="log-retention">
                                    <option value="30">30 days</option>
                                    <option value="90" selected>90 days</option>
                                    <option value="180">180 days</option>
                                    <option value="365">1 year</option>
                                    <option value="forever">Indefinitely</option>
                                </select>
                                <p class="checkbox-description">Compliance may require longer retention periods</p>
                            </div>
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary" id="save-audit-settings">
                                <i class="fas fa-save"></i> Save Audit Settings
                            </button>
                            <button class="btn btn-danger" id="clear-audit-logs">
                                <i class="fas fa-trash"></i> Clear Old Logs
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Settings Data
        const settingsState = {
            activeSection: 'data-sharing',
            users: [
                { id: 1, name: "Dr. Sarah Johnson", email: "s.johnson@hospital.org", role: "admin", department: "All", lastActive: "2 hours ago" },
                { id: 2, name: "Dr. Michael Chen", email: "m.chen@hospital.org", role: "physician", department: "Cardiology", lastActive: "1 day ago" },
                { id: 3, name: "Nurse Emily Rodriguez", email: "e.rodriguez@hospital.org", role: "nurse", department: "Neurology", lastActive: "3 hours ago" },
                { id: 4, name: "Dr. Robert Kim", email: "r.kim@hospital.org", role: "physician", department: "Orthopedics", lastActive: "Just now" },
                { id: 5, name: "Research Analyst Lisa Wang", email: "l.wang@hospital.org", role: "researcher", department: "All", lastActive: "5 days ago" }
            ],
            pharmaConnections: [
                { id: 1, company: "MediPharm Inc.", status: "active", dataAccess: "Full", connectionDate: "2023-05-15" },
                { id: 2, company: "NeuroHealth Pharma", status: "active", dataAccess: "Limited", connectionDate: "2023-07-22" },
                { id: 3, company: "HeartCare Corp", status: "pending", dataAccess: "Pending", connectionDate: "2023-10-10" },
                { id: 4, company: "Global Pharma Solutions", status: "active", dataAccess: "Full", connectionDate: "2023-03-30" }
            ],
            activities: [
                { id: 1, icon: "success", type: "User login", user: "Dr. Sarah Johnson", details: "Logged in from hospital network", time: "10:30 AM" },
                { id: 2, icon: "info", type: "Data export", user: "Dr. Michael Chen", details: "Exported cardiology safety report", time: "9:45 AM" },
                { id: 3, icon: "warning", type: "Alert response", user: "System", details: "Responded to MediPharm safety alert", time: "Yesterday, 3:15 PM" },
                { id: 4, icon: "info", type: "User added", user: "Dr. Sarah Johnson", details: "Added new nurse user", time: "Yesterday, 11:20 AM" },
                { id: 5, icon: "success", type: "Data shared", user: "System", details: "Shared anonymized data with NeuroHealth", time: "Oct 18, 2:00 AM" },
                { id: 6, icon: "info", type: "Settings changed", user: "Dr. Robert Kim", details: "Updated notification preferences", time: "Oct 17, 4:30 PM" },
                { id: 7, icon: "warning", type: "Failed login", user: "Unknown", details: "Failed login attempt from external IP", time: "Oct 16, 11:45 PM" }
            ]
        };

        // Initialize Settings Page
        document.addEventListener('DOMContentLoaded', function () {
            initializeSettingsPage();
            setupEventListeners();
            loadInitialData();
        });

        function initializeSettingsPage() {
            // Show first section by default
            showSettingsSection('data-sharing');

            // Populate users table
            populateUsersTable();

            // Populate pharma connections table
            populatePharmaConnectionsTable();

            // Populate activity log
            populateActivityLog();

            // Setup toggle for specific pharma access
            document.getElementById('specific-pharma-access').addEventListener('change', function () {
                const container = document.getElementById('pharma-list-container');
                container.style.display = this.checked ? 'block' : 'none';
            });
        }

        function showSettingsSection(sectionId) {
            // Update active nav link
            document.querySelectorAll('.settings-nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-section') === sectionId) {
                    link.classList.add('active');
                }
            });

            // Hide all sections
            document.querySelectorAll('.settings-section').forEach(section => {
                section.classList.remove('active');
            });

            // Show selected section
            document.getElementById(sectionId).classList.add('active');

            settingsState.activeSection = sectionId;
        }

        function populateUsersTable() {
            const tableBody = document.getElementById('users-table');
            tableBody.innerHTML = '';

            settingsState.users.forEach(user => {
                const row = document.createElement('tr');
                let roleClass = '';

                switch (user.role) {
                    case 'admin': roleClass = 'role-admin'; break;
                    case 'physician': roleClass = 'role-physician'; break;
                    case 'nurse': roleClass = 'role-nurse'; break;
                    case 'researcher': roleClass = 'role-pharma'; break;
                }

                row.innerHTML = `
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                    <td><span class="role-badge ${roleClass}">${user.role.charAt(0).toUpperCase() + user.role.slice(1)}</span></td>
                    <td>${user.department}</td>
                    <td>${user.lastActive}</td>
                    <td>
                        <button class="btn btn-secondary btn-sm" onclick="editUser(${user.id})" style="padding: 6px 12px; font-size: 13px;">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deleteUser(${user.id})" style="padding: 6px 12px; font-size: 13px; margin-left: 5px;">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function populatePharmaConnectionsTable() {
            const tableBody = document.getElementById('pharma-connections-table');
            tableBody.innerHTML = '';

            settingsState.pharmaConnections.forEach(connection => {
                const row = document.createElement('tr');
                let statusClass = connection.status === 'active' ? 'status-safe' : 'status-monitoring';

                row.innerHTML = `
                    <td><strong>${connection.company}</strong></td>
                    <td><span class="status-badge ${statusClass}">${connection.status.charAt(0).toUpperCase() + connection.status.slice(1)}</span></td>
                    <td>${connection.dataAccess}</td>
                    <td>${connection.connectionDate}</td>
                    <td>
                        <button class="btn btn-secondary btn-sm" style="padding: 6px 12px; font-size: 13px;">
                            <i class="fas fa-cog"></i> Configure
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="removeConnection(${connection.id})" style="padding: 6px 12px; font-size: 13px; margin-left: 5px;">
                            <i class="fas fa-times"></i>
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function populateActivityLog() {
            const activityLog = document.getElementById('activity-log');
            activityLog.innerHTML = '';

            settingsState.activities.forEach(activity => {
                const activityItem = document.createElement('div');
                activityItem.className = 'activity-item';

                let iconClass = '';
                switch (activity.icon) {
                    case 'success': iconClass = 'success'; break;
                    case 'warning': iconClass = 'warning'; break;
                    case 'info': iconClass = 'info'; break;
                }

                activityItem.innerHTML = `
                    <div class="activity-icon ${iconClass}">
                        <i class="fas fa-${activity.icon === 'success' ? 'check-circle' : activity.icon === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                    </div>
                    <div class="activity-content">
                        <strong>${activity.type}</strong> by ${activity.user}<br>
                        ${activity.details}
                        <div class="activity-time">${activity.time}</div>
                    </div>
                `;
                activityLog.appendChild(activityItem);
            });
        }

        function setupEventListeners() {
            // Settings navigation
            document.querySelectorAll('.settings-nav-link').forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();
                    const sectionId = this.getAttribute('data-section');
                    showSettingsSection(sectionId);
                });
            });

            // Add user button
            document.getElementById('add-user-btn').addEventListener('click', function () {
                const name = document.getElementById('new-user-name').value;
                const email = document.getElementById('new-user-email').value;
                const role = document.getElementById('new-user-role').value;
                const dept = document.getElementById('new-user-dept').value;

                if (!name || !email) {
                    alert('Please enter both name and email');
                    return;
                }

                // Add to users array
                const newId = settingsState.users.length + 1;
                settingsState.users.push({
                    id: newId,
                    name: name,
                    email: email,
                    role: role,
                    department: dept,
                    lastActive: 'Never'
                });

                // Update table
                populateUsersTable();

                // Clear form
                document.getElementById('new-user-name').value = '';
                document.getElementById('new-user-email').value = '';

                // Show success
                alert(`User ${name} added successfully`);
            });

            // Request connection button
            document.getElementById('request-connection').addEventListener('click', function () {
                const company = document.getElementById('new-pharma-company').value;
                const type = document.getElementById('connection-type').value;

                if (!company) {
                    alert('Please select a pharmaceutical company');
                    return;
                }

                // Get company name
                const companyName = document.getElementById('new-pharma-company').options[
                    document.getElementById('new-pharma-company').selectedIndex
                ].text;

                // Add to connections array
                const newId = settingsState.pharmaConnections.length + 1;
                settingsState.pharmaConnections.push({
                    id: newId,
                    company: companyName,
                    status: 'pending',
                    dataAccess: type === 'readonly' ? 'Read-only' : 'Full',
                    connectionDate: new Date().toISOString().split('T')[0]
                });

                // Update table
                populatePharmaConnectionsTable();

                // Show success
                alert(`Connection requested with ${companyName}`);
            });

            // Save buttons
            document.getElementById('save-data-sharing').addEventListener('click', function () {
                saveSettings('data-sharing');
            });

            document.getElementById('save-notifications').addEventListener('click', function () {
                saveSettings('notifications');
            });

            document.getElementById('save-user-settings').addEventListener('click', function () {
                saveSettings('user-management');
            });

            document.getElementById('save-compliance').addEventListener('click', function () {
                saveSettings('privacy-compliance');
            });

            document.getElementById('save-pharma-settings').addEventListener('click', function () {
                saveSettings('pharma-connections');
            });

            document.getElementById('save-api-settings').addEventListener('click', function () {
                saveSettings('api-integration');
            });

            document.getElementById('save-backup-settings').addEventListener('click', function () {
                saveSettings('backup-recovery');
            });

            document.getElementById('save-audit-settings').addEventListener('click', function () {
                saveSettings('audit-log');
            });

            // Emergency delete button
            document.getElementById('emergency-delete').addEventListener('click', function () {
                if (confirm('WARNING: This will delete all shared data with pharmaceutical companies. This action cannot be undone. Are you sure?')) {
                    if (confirm('Are you absolutely sure? This may violate data retention requirements.')) {
                        alert('Emergency deletion initiated. All shared data will be deleted within 24 hours.');
                        // In a real app, this would trigger an API call
                    }
                }
            });

            // Copy API key button
            document.getElementById('copy-api-key').addEventListener('click', function () {
                const apiKey = document.getElementById('api-key');
                apiKey.select();
                document.execCommand('copy');
                alert('API key copied to clipboard');
            });

            // Regenerate API key button
            document.getElementById('regenerate-api-key').addEventListener('click', function () {
                if (confirm('Regenerating the API key will invalidate the current key. Existing integrations using this key will stop working. Continue?')) {
                    // Generate a new key
                    const newKey = 'sk_hosp_' + Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
                    document.getElementById('api-key').value = newKey;
                    alert('New API key generated. Update all integrations with this new key.');
                }
            });

            // Manual backup button
            document.getElementById('manual-backup').addEventListener('click', function () {
                alert('Manual backup initiated. This may take several minutes depending on data size.');
                // In a real app, this would trigger a backup process
            });

            // Apply log filters button
            document.getElementById('apply-log-filters').addEventListener('click', function () {
                alert('Filters applied to activity log');
                // In a real app, this would filter the activity log
            });

            // Export logs button
            document.getElementById('export-logs').addEventListener('click', function () {
                alert('Logs exported successfully');
                // In a real app, this would generate a log file for download
            });

            // Clear audit logs button
            document.getElementById('clear-audit-logs').addEventListener('click', function () {
                if (confirm('Clear all audit logs older than retention period? This action cannot be undone.')) {
                    alert('Old audit logs cleared');
                    // In a real app, this would delete old logs
                }
            });
        }

        function saveSettings(section) {
            // Collect settings from the section
            let settings = {};

            switch (section) {
                case 'data-sharing':
                    settings.autoAnonymize = document.getElementById('auto-anonymize').checked;
                    settings.minGroupSize = document.getElementById('min-group-size').value;
                    settings.shareDemographics = document.getElementById('share-demographics').checked;
                    settings.shareDiagnosis = document.getElementById('share-diagnosis').checked;
                    settings.shareMedication = document.getElementById('share-medication').checked;
                    settings.shareOutcomes = document.getElementById('share-outcomes').checked;
                    settings.shareGeographic = document.getElementById('share-geographic').checked;
                    settings.allPharmaAccess = document.getElementById('all-pharma-access').checked;
                    settings.specificPharmaAccess = document.getElementById('specific-pharma-access').checked;
                    break;

                case 'notifications':
                    settings.notifySafetyAlerts = document.getElementById('notify-safety-alerts').checked;
                    settings.alertSeverity = document.getElementById('alert-severity').value;
                    settings.notifyEmail = document.getElementById('notify-email').checked;
                    settings.notifySMS = document.getElementById('notify-sms').checked;
                    settings.notifyDashboard = document.getElementById('notify-dashboard').checked;
                    settings.dailySummaryTime = document.getElementById('daily-summary-time').value;
                    settings.weeklyReportDay = document.getElementById('weekly-report-day').value;
                    break;

                case 'user-management':
                    settings.defaultRole = document.getElementById('default-role').value;
                    settings.allowDataExport = document.getElementById('allow-data-export').checked;
                    settings.allowPatientAdd = document.getElementById('allow-patient-add').checked;
                    settings.allowSettingsChange = document.getElementById('allow-settings-change').checked;
                    break;

                case 'privacy-compliance':
                    settings.anonRetention = document.getElementById('anon-retention').value;
                    settings.patientRetention = document.getElementById('patient-retention').value;
                    settings.autoDelete = document.getElementById('auto-delete').checked;
                    settings.requireConsent = document.getElementById('require-consent').checked;
                    settings.twoFactorAuth = document.getElementById('two-factor-auth').checked;
                    settings.sessionTimeout = document.getElementById('session-timeout').checked;
                    break;
            }

            // In a real app, this would send settings to the server
            console.log(`Saving ${section} settings:`, settings);

            // Show success message
            alert('Settings saved successfully');

            // Add to activity log
            const newActivity = {
                id: settingsState.activities.length + 1,
                icon: 'success',
                type: 'Settings updated',
                user: 'Current User',
                details: `Updated ${section.replace('-', ' ')} settings`,
                time: 'Just now'
            };
            settingsState.activities.unshift(newActivity);
            populateActivityLog();
        }

        function loadInitialData() {
            // Load saved settings from localStorage or server
            // For demo purposes, we'll set some default values

            // Set default values for data sharing
            document.getElementById('auto-anonymize').checked = true;
            document.getElementById('min-group-size').value = '10';
            document.getElementById('share-demographics').checked = true;
            document.getElementById('share-diagnosis').checked = true;
            document.getElementById('share-medication').checked = true;
            document.getElementById('share-outcomes').checked = true;
            document.getElementById('all-pharma-access').checked = true;

            // Set default values for notifications
            document.getElementById('notify-safety-alerts').checked = true;
            document.getElementById('alert-severity').value = 'moderate';
            document.getElementById('notify-email').checked = true;
            document.getElementById('notify-dashboard').checked = true;
            document.getElementById('daily-summary-time').value = '17:00';
            document.getElementById('weekly-report-day').value = 'friday';

            // Set default values for user management
            document.getElementById('default-role').value = 'physician';
            document.getElementById('allow-data-export').checked = true;
            document.getElementById('allow-patient-add').checked = true;

            // Set default values for privacy & compliance
            document.getElementById('anon-retention').value = '5';
            document.getElementById('patient-retention').value = '10';
            document.getElementById('auto-delete').checked = true;
            document.getElementById('require-consent').checked = true;
            document.getElementById('two-factor-auth').checked = true;
            document.getElementById('session-timeout').checked = true;
        }

        // User management functions
        function editUser(userId) {
            const user = settingsState.users.find(u => u.id === userId);
            if (user) {
                // In a real app, this would open an edit modal
                alert(`Edit user: ${user.name}\n\nThis would open an edit form in a real application.`);
            }
        }

        function deleteUser(userId) {
            if (confirm('Are you sure you want to delete this user? They will lose access to the dashboard.')) {
                settingsState.users = settingsState.users.filter(u => u.id !== userId);
                populateUsersTable();
                alert('User deleted successfully');
            }
        }

        function removeConnection(connectionId) {
            if (confirm('Are you sure you want to remove this pharmaceutical connection?')) {
                settingsState.pharmaConnections = settingsState.pharmaConnections.filter(c => c.id !== connectionId);
                populatePharmaConnectionsTable();
                alert('Connection removed successfully');
            }
        }
    </script>
</body>

</html>