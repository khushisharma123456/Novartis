<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Doctor Dashboard - MedSafe</title><link rel="stylesheet" href="../css/style.css"><script src="https://unpkg.com/lucide@latest"></script><script type="module" src="../js/sidebar.js"></script></head><body><div class="dashboard-layout"><app-sidebar></app-sidebar><main class="main-content"><header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;"><div><h1>Dashboard</h1><p>Welcome back,
Dr. <span id="doctor-name">User</span></p></div><button class="btn btn-primary" onclick="window.location.href='patients.html'">+New Patient</button></header>< !-- Summary Cards --><div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;"><div class="card"><div style="display: flex; justify-content: space-between; align-items: start;"><div><p style="margin: 0; font-size: 0.9rem;">Active Patients</p><h2 style="margin: 0.5rem 0 0 0; font-size: 2rem;" id="stat-total">0</h2></div><div style="padding: 0.5rem; background: var(--secondary); border-radius: 8px; color: var(--primary-dark);"><i data-lucide="users"></i></div></div></div><div class="card"><div style="display: flex; justify-content: space-between; align-items: start;"><div><p style="margin: 0; font-size: 0.9rem;">High Risk Alerts</p><h2 style="margin: 0.5rem 0 0 0; font-size: 2rem; color: #DC2626;" id="stat-high">0</h2></div><div style="padding: 0.5rem; background: #FEF2F2; border-radius: 8px; color: #DC2626;"><i data-lucide="alert-triangle"></i></div></div></div><div class="card"><div style="display: flex; justify-content: space-between; align-items: start;"><div><p style="margin: 0; font-size: 0.9rem;">Pending Reviews</p><h2 style="margin: 0.5rem 0 0 0; font-size: 2rem;" id="stat-pending">0</h2></div><div style="padding: 0.5rem; background: var(--secondary); border-radius: 8px; color: var(--text-muted);"><i data-lucide="clipboard-list"></i></div></div></div></div>< !-- Today's Alerts -->
 <section><h3 style="margin-bottom: 1rem;">Today's Alerts</h3>
 <div class="card" id="alerts-container">< !-- Dynamic Content --><p style="text-align: center; padding: 2rem;">No active alerts required your attention.</p></div></section></main></div><script type="module">import {
    Auth
}

from '../js/auth.js';

import {
    DoctorApp
}

from '../js/doctor.js';

// Auth Check
const user=Auth.requireAuth();

if (user.role !=='doctor') {
    window.location.href='../login.html'; // Basic protection
}

document.getElementById('doctor-name').textContent=user.name;
lucide.createIcons();

// Load Stats
const stats=DoctorApp.getStats();
document.getElementById('stat-total').textContent=stats.total;
document.getElementById('stat-high').innerText=stats.highRisk;
// Mock pending for now
document.getElementById('stat-pending').textContent=Math.floor(stats.total * 0.2);

// Load Alerts (Mock logic based on high risk patients)
const patients=DoctorApp.getPatients();
const highRiskPatients=patients.filter(p=> p.riskLevel==='High');

if (highRiskPatients.length > 0) {
    const container=document.getElementById('alerts-container');

    container.innerHTML=`<div style="display: flex; flex-direction: column; gap: 1rem;">$ {
        highRiskPatients.map(p=> ` <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; border: 1px solid #E2E8F0; border-radius: 8px;" > <div style="display: flex; gap: 1rem; align-items: center;" > <div style="background: #FEF2F2; padding: 0.5rem; border-radius: 50%; color: #DC2626;" > <i data-lucide="alert-octagon" ></i> </div> <div> <strong style="display: block;" >High Risk Detected</strong> <span style="font-size: 0.9rem; color: var(--text-muted);" >Patient $ {
                p.id
            }

            - $ {
                p.drugName || 'Unknown Drug'
            }

            </span> </div> </div> <a href="patients.html?id=${p.id}" class="btn btn-outline" style="font-size: 0.85rem;" >Review Case</a> </div> `).join('')
    }

    </div>`;
    lucide.createIcons(); // Re-run for dynamic icons
}

</script></body></html>